; Generated by Helix Python Compiler
.ORG 0x0000
LDI.W SP, 0x6000 ; Initialize Stack
CALL main
HLT

; Function: factorial
factorial:
ADD.W SP, SP, -1
ST.W FP, [SP, 0]
MOV.W FP, SP
ADD.W SP, SP, -1
ST.W R14, [SP, 0]
LD.W R1, [FP, 1] ; Load n
ADD.W SP, SP, -1
ST.W R1, [SP, 0]
LDI.W R1, 1
MOV.W R2, R1
LD.W R1, [SP, 0]
ADD.W SP, SP, 1
CMP.W R1, R2
BLT L_cmp_true_3
LDI.W R1, 0
JMP L_cmp_end_4
L_cmp_true_3:
LDI.W R1, 1
L_cmp_end_4:
CMP.W R1, 0
BEQ L_else_1
LDI.W R1, 1
MOV.W SP, FP
ADD.W SP, SP, -1
LD.W R14, [SP, 0]
ADD.W SP, SP, 1
LD.W FP, [SP, 0]
ADD.W SP, SP, 1
RET
JMP L_if_end_2
L_else_1:
LD.W R1, [FP, 1] ; Load n
ADD.W SP, SP, -1
ST.W R1, [SP, 0]
LD.W R1, [FP, 1] ; Load n
ADD.W SP, SP, -1
ST.W R1, [SP, 0]
LDI.W R1, 1
MOV.W R2, R1
LD.W R1, [SP, 0]
ADD.W SP, SP, 1
SUB.W R1, R1, R2
ADD.W SP, SP, -1
ST.W R1, [SP, 0]
CALL factorial
ADD.W SP, SP, 1 ; Clean up args
MOV.W R2, R1
LD.W R1, [SP, 0]
ADD.W SP, SP, 1
MUL.W R1, R1, R2
MOV.W SP, FP
ADD.W SP, SP, -1
LD.W R14, [SP, 0]
ADD.W SP, SP, 1
LD.W FP, [SP, 0]
ADD.W SP, SP, 1
RET
L_if_end_2:
MOV.W SP, FP
ADD.W SP, SP, -1
LD.W R14, [SP, 0]
ADD.W SP, SP, 1
LD.W FP, [SP, 0]
ADD.W SP, SP, 1
RET

; Function: main
main:
ADD.W SP, SP, -1
ST.W FP, [SP, 0]
MOV.W FP, SP
ADD.W SP, SP, -1
ST.W R14, [SP, 0]
LDI.W R1, 5
ADD.W SP, SP, -1
ST.W R1, [SP, 0]
CALL factorial
ADD.W SP, SP, 1 ; Clean up args
MOV.W SP, FP
ADD.W SP, SP, -1
LD.W R14, [SP, 0]
ADD.W SP, SP, 1
LD.W FP, [SP, 0]
ADD.W SP, SP, 1
RET
MOV.W SP, FP
ADD.W SP, SP, -1
LD.W R14, [SP, 0]
ADD.W SP, SP, 1
LD.W FP, [SP, 0]
ADD.W SP, SP, 1
RET
